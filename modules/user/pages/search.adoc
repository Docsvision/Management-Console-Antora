= Поиск входящих сообщений карточки

Данный виджет предназначен для получения списка входящих сообщений по обработке указанной карточки. Виджет может использоваться для диагностики проблемных карточек.

== Виджет поиска

.Текстовый виджет "Поиск входящих сообщений карточки"
image::search-text-dash.png[Текстовый виджет "Поиск входящих сообщений карточки"]

include::partial$excerpts.adoc[tags=contains]
. Строка для указания идентификатора карточки.
. Таблица с указанием результатов поиска. В первом столбце указывается _Состояние_ найденной карточки, во втором -- _Количество сообщений_.
+
Виджет выводит количество сообщений в каждом состоянии: _Обработано_, _Не обработано_, _Ошибка_, _Блокировано_. Количество сообщений в состоянии _Блокировано_ означает сообщения, имеющие блокировку, но не количество самих блокировок.

Виджет выводит информацию по идентификатору карточки. Каждому идентификатору соответствует карточка сообщения, в которой содержится список входящих сообщений по указанной карточке. Каждое входящие имеет уникальный идентификатор RowID и состояние State, содержащиеся в карточке сообщения.

Полная информация по найденной карточке доступна на странице "Сообщения карточки".

== Страница "Сообщения карточки"

image::widgetsOfWSMessagesOfCardAsGraph.png[Виджет Поиск входящих сообщений карточки (графический)]

include::partial$excerpts.adoc[tags=page]

Виджет содержит следующие элементы:

* заголовок с названием виджета, датой последнего обновления отображаемой информации и кнопкой обновления;

&gt; Данные автоматически обновляются с периодом 30 секунд.

* поле для выбора подключения к {dv}, из которого будут загружаться данные;

* поле для ввода идентификатора карточки, по которой нужно отображать статистику;

* гистограмму, на которой представлено количественное соотношение сообщений с разными состояниями обработки: Обработано, Не обработано, Ошибок и Блокировано (количество сообщений с блокировкой). При щелчке по столбцу будет выполнен переход к странице xref:InfoPagesOfWSMessagesOfCard.adoc[Поиск сообщений карточки]. ==В требовании на страницу нет фильтров (отменены)==

== Использование виджета

. Выберите xref:ConfigConnections.adoc[подключение] к {dv}, из которого будут загружаться данные.

. В поле *Идентификатор карточки* введите идентификатор карточки, для которой нужна статистика обработки сообщений, нажмите кнопку *Найти*. В графиках отобразится статистка обработки сообщений карточки.

Поиск сообщений может завершиться ошибкой:

* Карточка с идентификатором …. не найдена -- если карточка с указанным идентификатором не найдена в системе {dv}.
* Входящие сообщения для карточки с идентификатором … не найдены -- если не найдены входящие сообщения для указанной карточки.
* Введен некорректный идентификатор. Для карточки с идентификатором … входящих сообщений не существует -- если тип указанной карточки не поддерживает обработку Службой {ws}, и для неё не зарегистрирован тип входящих сообщений.
. Для перехода к xref:InfoPagesOfWSMessagesOfCard.adoc[Поиск сообщений карточки], содержащей полную информацию об обработке сообщений по данной карточке, щелкните по любому столбцу гистограммы.

У пользователя наблюдается проблема с карточкой задания:
Администратор получает ID проблемного задания (из ВК или навигатора)
В админке в поле ввода данного виджета вводит идентификатор, получает сведения о сообщениях
Наличие сообщений в состоянии "обработано" говорит о том, что карточка начала обрабатываться (даже если далее есть ошибки/блокировки)
Наличие сообщений в состоянии "не обработано" говорит о том, что логика карточки Задания возможно была еще не до конца выполнена, в связи с чем пользователю не приходит задание (например)
Наличие сообщений в состоянии "ошибка" говорит о том, что некоторые события не смогли быть корректно обработаны, в связи с чем у пользователя возникли сложности. Для решения этой проблемы Администратору нужно перейти на страницу со списком входящих сообщений по этой карточке и перейти на страницу Ошибок и блокировок, чтобы увидеть имеющиеся ошибки
Наличие блокировок говорит о том, что часть сообщений были заблокированы внешними событиями. Заблокированы могут быть сообщения в состоянии "не обработано" и "ошибка". При блокировке процесс стопорится, чтобы он возобновился необходимо пойти на страницу со списком входящих сообщений оттуда перейти на страницу ошибок и блокировок и снять все блокировки.
Сообщение может изменить свой статус один раз: из "не обработано" в "ошибку" или в "обработано". Поэтому после разрешения ошибок, будет заново получено входящее сообщение, ожидающее обработку, но сообщение в "ошибка", свой статус не поменяет и все равно будет отображаться! 