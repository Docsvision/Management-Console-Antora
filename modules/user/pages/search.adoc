= Поиск входящих сообщений карточки

Данный виджет предназначен для получения списка входящих сообщений по обработке указанной карточки. Виджет может использоваться для диагностики проблемных карточек.

== Виджет поиска

.Текстовый виджет "Поиск входящих сообщений карточки"
image::search-text-dash.png[Текстовый виджет "Поиск входящих сообщений карточки"]

include::partial$excerpts.adoc[tags=contains]
. Строка для указания идентификатора карточки.
. Таблица с указанием результатов поиска. В первом столбце указывается _Состояние_ найденной карточки, во втором -- _Количество сообщений_.
+
На виджете отображается количество сообщений в каждом состоянии: _Обработано_, _Не обработано_, _Ошибка_, _Блокировано_. Количество сообщений в состоянии _Блокировано_ означает сообщения, имеющие блокировку, но не количество самих блокировок.

Виджет выводит информацию по идентификатору карточки. Каждому идентификатору соответствует карточка сообщения, в которой содержится список входящих сообщений по указанной карточке. Каждое входящие имеет уникальный идентификатор RowID и состояние State, содержащиеся в карточке сообщения.

Полная информация по найденной карточке доступна на странице _Сообщения карточки_.

.В таблице со списком сообщений могут отображаться следующие сообщения:
* `Карточка с идентификатором .... не найдена`, если карточка не найдена в системе.
* Число сообщений = 0 в каждой строке таблицы, если карточка найдена, но не найдены сообщения.
* `Сообщения не поддерживаются` если введен идентификатор карточки, для которой не может быть создана карточка сообщений.

== Страница "Сообщения карточки"

image::search-text-page.png[]

== Графическая реализация?

image::widgetsOfWSMessagesOfCardAsGraph.png[Виджет Поиск входящих сообщений карточки (графический)]

include::partial$excerpts.adoc[tags=page]

Виджет содержит следующие элементы:

* заголовок с названием виджета, датой последнего обновления отображаемой информации и кнопкой обновления;

&gt; Данные автоматически обновляются с периодом 30 секунд.

* поле для выбора подключения к {dv}, из которого будут загружаться данные;

* поле для ввода идентификатора карточки, по которой нужно отображать статистику;

* гистограмму, на которой представлено количественное соотношение сообщений с разными состояниями обработки: Обработано, Не обработано, Ошибок и Блокировано (количество сообщений с блокировкой). При щелчке по столбцу будет выполнен переход к странице xref:InfoPagesOfWSMessagesOfCard.adoc[Поиск сообщений карточки]. ==В требовании на страницу нет фильтров (отменены)==

== Использование виджета

ifdef::question[]
. Выберите xref:ConfigConnections.adoc[подключение] к {dv}, из которого будут загружаться данные.

. В поле *Идентификатор карточки* введите идентификатор карточки, для которой нужна статистика обработки сообщений, нажмите кнопку *Найти*. В графиках отобразится статистка обработки сообщений карточки.

. Для перехода к xref:InfoPagesOfWSMessagesOfCard.adoc[Поиск сообщений карточки], содержащей полную информацию об обработке сообщений по данной карточке, щелкните по любому столбцу гистограммы.
endif::[]

Если у пользователя возникает проблема с карточкой _Задания_, администратор может проанализировать карточку при помощи виджета.

. Администратор должен получить ID проблемного задания из {wc} или {wincl}.
. Перейти в консоль управления, ввести ID в поле ввода данного виджета, чтобы получить сведения о сообщениях.
. Наличие сообщений в состоянии *_Обработано_* может говорить о том, что карточка начала обрабатываться даже если далее есть ошибки или блокировки.
. Наличие сообщений в состоянии *_Не обработано_* может говорить о том, что логика карточки _Задания_ возможно была еще не до конца выполнена, в связи с чем пользователю не приходит задание.
. Наличие сообщений в состоянии *_Ошибка_* говорит о том, что некоторые события не смогли быть корректно обработаны, в связи с чем у пользователя возникли сложности.
. Чтобы решить проблему, администратор должен будет перейти на страницу со списком входящих сообщений по этой карточке, а затем открыть страницу _Сообщений карточки_, на ней вкладку _Входящих сообщений карточки_.
. На вкладке будут отображены все сообщения карточки, включая _Ошибки и блокировки_.
. Наличие блокировок говорит о том, что часть сообщений были заблокированы внешними событиями. Заблокированы могут быть сообщения в состоянии _Не обработано_ и _Ошибка_.
. При блокировке процесс останавливается. Чтобы процесс возобновился, необходимо открыть страницу _Сообщений карточки_, на ней вкладку _Входящих сообщений карточки_. Затем перейти на страницу _Ошибок и блокировок_ и снять все блокировки.
. После разрешения ошибок входящее сообщение, ожидающее обработку может изменить свой статус один раз: из _Не обработано_ в _Ошибку_ или в _Обработано_.
+
CAUTION: Сообщение в состоянии *_Ошибка_*, не поменяет статус и все равно будет отображаться.