= Установка и первоначальная настройка Консоли управления

== Состав установочного комплекта

. Пакет установки Консоли управления {dv}: `{dv} 5 ManagementConsole.msi`.

== Установка Консоли управления

Инсталлятор установит одновременно {wac} и Хранилище (сервис) настроек. Установка должна выполняться на одной машине, установка на разные серверы не поддерживается.

.Чтобы установить Консоль управления:
. Откройте пакет установки `{dv} 5 ManagementConsole.msi`.
+
Пользователь, выполняющий установку, получит xref:provide-access.adoc[доступ] к Консоли настроек {dv} (будет добавлен в группы *{wacs-g}* и *{wacss-g}*).
+
.Установка Консоли управления {dv}
image::install-hello.png[Установка Консоли управления {dv}]
+
. Нажмите *Далее*, ознакомьтесь с условиями лицензионного соглашения.  Подтвердите, что вы согласны с лицензионным соглашением и нажмите *Далее*.
+
.Лицензионное соглашение
image::install-license.png[Лицензионное соглашение]
+
. При необходимости выберите место установки Консоли управления.
+
.Выбор расположения установки
image::install-location.png[Выбор расположения установки]
+
. На следующем шаге будет предложено указать настройки Консоли управления.
+
.Настройки Консоли управления
image::install-settings.png[Настройки Консоли управления]
+
****
Порт для Консоли управления {dv}::
Порт для доступа к Консоли управления из браузера по HTTP. По умолчанию `5100`.

Порт для Сервиса настроек::
Порт для подключения Консоли к хранилищу настроек. По умолчанию `5200` соответственно.

Порт для Сервиса внешнего API Консоли управления {dv}::
Порт для доступа к внешнему REST API Консоли. Данный сервис предоставляет возможность получения сообщений и списка сообщений из системы {dv}.
+
Соединение между Консолью и сервисом устанавливается от имени авторизованного пользователя Консоли. Сервис также проверяет пользователя на принадлежность к группе *{wacs-g}*.
+
Сессия в Сервисе запускается от имени пользователя, запустившего Сервис или пул IIS.

Выберите тип сервера БД из списка::
Microsoft SQL Server или PostgreSQL в зависимости от используемой базы данных.

Строка подключения к базе данных для хранения настроек::
В строке укажите адрес подключения к базе данных для хранения настроек в формате: `Data Source=<sql_server>;Initial Catalog=<db_name>;Integrated Security=False;User ID=<sql_login>;Password=<sql_user_password>`.
+
* `<sql_server>` -- адрес сервера SQL для подключения к БД.
* `<db_name>` -- псевдоним базы данных.
* `Integrated Security=False` -- SQL-аутентификация: true -- используется, false -- не используется.
* `<sql_login>` -- учётная запись пользователя для подключения к БД.
* `<sql_user_password>` -- пароль учётной записи для подключения к БД.
****
+
include::5.5.2@workerservice:admin:page$install.adoc[tags=confirm]
+
.Продолжить установку или вернуться на предыдущий шаг
image::install-confirm.png[Продолжить установку или вернуться на предыдущий шаг]
+
include::5.5.2@workerservice:admin:page$install.adoc[tags=finish]

.После установки на сервер будет добавлены две локальные группы Windows:
. *{wacs-g}* -- пользователи, входящие в эту группу, имеют право работать с Консолью управления {dv}.
. *{wacss-g}* -- пользователи, входящие в эту группу, имеют право менять настройки в хранилище настроек.

== Настройка Консоли управления

Установка создаёт файл в формате JSON c настройками Консоли управления по умолчанию для BackOffice.
В JSON файле содержатся: имена типов реализаций подключаемых к Службе {ws}, настройки их сопоставления, роли обработки задач BackOffice, а также настройки самой Службы {ws} (включая очереди, фабрики и прочие).

Установка приносит настройки, которые не зависят от машины где развертываемся.

== Удаление Консоли управления

Чтобы удалить Консоль управления, запустите инсталлятор в режиме удаления.

Созданные группы и службы будут удалены, хранилище настроек станет недоступно.
